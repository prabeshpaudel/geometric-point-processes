---
title: "Ripser"
author: "Ken Wang"
date: "9/15/2020"
output:
  html_document:
    df_print: paged
  pdf_document: default
  html_notebook: default
---

```{r,message=FALSE,warning=FALSE}
library("ripserr")
library(tidyverse)
```

```{r}
rand = data.frame(replicate(2000,runif(100, -10, 10)))
deg0 = data.frame(matrix(0, nrow = 99, ncol = 1000))
deg1 = data.frame(num=numeric(1000),birth_mean=numeric(1000),birth_min=numeric(1000),
                  birth_max=numeric(1000),death_mean=numeric(1000),death_min=numeric(1000),
                  death_max=numeric(1000),range_mean=numeric(1000),range_min=numeric(1000),
                  range_max=numeric(1000))

for(i in 1:1000){
  rips = vietoris_rips(rand[,c(i,i+1000)])
  deg0[,i] = rips$death[1:99]
  rips1 = rips[100:nrow(rips),]
  rips1$range = rips1$death - rips1$birth
  deg1$num[i] = nrow(rips1)
  deg1$birth_min[i] = rips1$birth[nrow(rips1)]
  deg1$birth_max[i] = rips1$birth[1]
  deg1$birth_mean[i] = mean(rips1$birth)
  deg1$death_min[i] = min(rips1$death)
  deg1$death_max[i] = max(rips1$death)
  deg1$death_mean[i] = mean(rips1$death)
  deg1$range_min[i] = min(rips1$range)
  deg1$range_max[i] = max(rips1$range)
  deg1$range_mean[i] = mean(rips1$range)
}
```

```{r}
# degree 0
(range(deg0)) # range
deg0row_means = rowMeans(deg0) # rowmeans
plot1 = data.frame(num=1:99,length=deg0row_means)
plot1 %>%
  ggplot(aes(x=num,y=length))+
  geom_bar(stat="identity", fill="steelblue")+
  theme_minimal()

deg0_1 = pivot_longer(deg0,cols=1:1000)
deg0_1 %>%
  ggplot()+
  geom_histogram(aes(x=value),stat="bin")
summary(deg0_1$value)
```

```{r,warning=FALSE}
# degree 1
#summarise_all(deg1,list(min=min,max=max,mean=mean))
summary(deg1$num)
summary(deg1$birth_mean)
summary(deg1$birth_min)
summary(deg1$birth_max)
summary(deg1$death_mean)
summary(deg1$death_min)
summary(deg1$death_max)
summary(deg1$range_mean)
summary(deg1$range_min)
summary(deg1$range_max)

deg1$trial=1:1000

deg1 %>%
  ggplot(aes(x=as.factor(num)))+
  geom_bar(fill="steelblue")+
  theme_minimal()
  
deg1 %>%
  ggplot()+
  geom_histogram(aes(x=birth_mean),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=birth_min),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=birth_max),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=death_mean),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=death_min),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=death_max),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=range_mean),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=range_min),stat="bin")

deg1 %>%
  ggplot()+
  geom_histogram(aes(x=range_max),stat="bin")
```

